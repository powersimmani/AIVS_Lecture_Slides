<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feed-Forward Network & Layer Normalization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            gap: 40px;
            padding: 20px 0;
        }
        
        .container {
            width: 960px;
            height: 540px;
            padding: 30px;
            background: white;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .title {
            text-align: center;
            font-size: 24px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 4px;
        }
        
        .main-content {
            display: flex;
            gap: 16px;
            flex: 1;
        }
        
        .ffn-section {
            flex: 1.2;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .ffn-box {
            background: #f0f7ff;
            border: 3px solid #1E64C8;
            border-radius: 12px;
            padding: 18px 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .section-header {
            text-align: center;
            font-size: 19px;
            font-weight: 600;
            color: #1E64C8;
            padding-bottom: 10px;
            border-bottom: 2px solid #1E64C8;
            margin-bottom: 4px;
        }
        
        .formula-box {
            background: white;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }
        
        .formula {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            color: #1E64C8;
            font-weight: 600;
            line-height: 1.6;
        }
        
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 8px 0;
        }
        
        .flow-step {
            background: white;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 12px 16px;
            text-align: center;
            flex: 1;
        }
        
        .step-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 4px;
        }
        
        .step-value {
            font-size: 17px;
            font-weight: 600;
            color: #1E64C8;
        }
        
        .arrow {
            font-size: 24px;
            color: #1E64C8;
            font-weight: 700;
        }
        
        .info-item {
            display: flex;
            align-items: start;
            gap: 10px;
            background: white;
            border-radius: 6px;
            padding: 10px 12px;
        }
        
        .info-icon {
            font-size: 18px;
            margin-top: 2px;
            flex-shrink: 0;
        }
        
        .info-text {
            font-size: 15px;
            color: #333;
            line-height: 1.4;
        }
        
        .highlight-blue {
            font-weight: 600;
            color: #1E64C8;
        }
        
        .layernorm-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .layernorm-box {
            background: #f0fdf4;
            border: 3px solid #16a34a;
            border-radius: 12px;
            padding: 18px 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .layernorm-box .section-header {
            color: #16a34a;
            border-color: #16a34a;
        }
        
        .property-card {
            background: white;
            border: 2px solid #16a34a;
            border-radius: 8px;
            padding: 12px 14px;
            display: flex;
            gap: 10px;
            align-items: start;
        }
        
        .property-icon {
            font-size: 22px;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .property-content {
            flex: 1;
        }
        
        .property-title {
            font-size: 16px;
            font-weight: 600;
            color: #16a34a;
            margin-bottom: 4px;
        }
        
        .property-text {
            font-size: 14px;
            color: #333;
            line-height: 1.3;
        }
        
        .highlight-green {
            font-weight: 600;
            color: #16a34a;
        }
        
        .placement-box {
            background: #fff9f0;
            border: 2px solid #f59e0b;
            border-radius: 8px;
            padding: 12px 16px;
            text-align: center;
        }
        
        .placement-title {
            font-size: 16px;
            font-weight: 600;
            color: #d97700;
            margin-bottom: 4px;
        }
        
        .placement-text {
            font-size: 15px;
            color: #333;
            line-height: 1.4;
        }
        
        .placement-highlight {
            font-weight: 600;
            color: #d97700;
        }

        /* ===== Í≥ÑÏÇ∞ ÏòàÏãú ÏÑπÏÖò Ïä§ÌÉÄÏùº ===== */
        .example-container {
            width: 960px;
            padding: 30px;
            background: white;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .example-box {
            background: #f0fdf4;
            border: 3px solid #16a34a;
            border-radius: 12px;
            padding: 20px 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .example-title {
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            color: #16a34a;
            padding-bottom: 12px;
            border-bottom: 2px solid #16a34a;
        }

        .formula-section {
            background: white;
            border: 2px solid #16a34a;
            border-radius: 8px;
            padding: 16px 20px;
        }

        .formula-title {
            font-size: 15px;
            font-weight: 600;
            color: #16a34a;
            margin-bottom: 10px;
        }

        .formula-content {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: #333;
            line-height: 1.8;
            text-align: center;
        }

        .calc-step {
            background: white;
            border: 2px solid #16a34a;
            border-radius: 8px;
            padding: 16px 20px;
        }

        .step-title {
            font-size: 15px;
            font-weight: 600;
            color: #16a34a;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step-number {
            background: #16a34a;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 700;
        }

        .calc-content {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #333;
            line-height: 1.8;
            background: #f8fdf9;
            padding: 12px 16px;
            border-radius: 6px;
            overflow-x: auto;
        }

        .calc-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 4px 0;
        }

        .matrix-display {
            display: inline-block;
            margin: 8px 0;
        }

        .result-box {
            background: #dcfce7;
            border: 2px solid #16a34a;
            border-radius: 8px;
            padding: 14px 20px;
            text-align: center;
        }

        .result-label {
            font-size: 14px;
            color: #16a34a;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .result-value {
            font-family: 'Courier New', monospace;
            font-size: 15px;
            color: #333;
            font-weight: 600;
        }

        .note-box {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            gap: 10px;
            align-items: start;
        }

        .note-icon {
            font-size: 18px;
        }

        .note-text {
            font-size: 14px;
            color: #92400e;
            line-height: 1.5;
        }

        .highlight-orange {
            font-weight: 600;
            color: #d97706;
        }

        .two-column {
            display: flex;
            gap: 16px;
        }

        .two-column > * {
            flex: 1;
        }
    </style>
</head>
<body>
    <!-- Í∏∞Ï°¥ Ïä¨ÎùºÏù¥Îìú -->
    <div class="container">
        <div class="title">Feed-Forward Network & Layer Normalization</div>
        
        <div class="main-content">
            <div class="ffn-section">
                <div class="ffn-box">
                    <div class="section-header">üî∑ Feed-Forward Network (FFN)</div>
                    
                    <div class="formula-box">
                        <div class="formula">
                            FFN(x) = max(0, xW‚ÇÅ + b‚ÇÅ)W‚ÇÇ + b‚ÇÇ
                        </div>
                    </div>
                    
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="step-label">Input</div>
                            <div class="step-value">d_model<br><span style="font-size: 14px;">(512)</span></div>
                        </div>
                        <div class="arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="step-label">Hidden</div>
                            <div class="step-value">4√ód_model<br><span style="font-size: 14px;">(2048)</span></div>
                        </div>
                        <div class="arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="step-label">Output</div>
                            <div class="step-value">d_model<br><span style="font-size: 14px;">(512)</span></div>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">üîß</div>
                        <div class="info-text">
                            Two <span class="highlight-blue">linear transformations</span> with <span class="highlight-blue">ReLU activation</span>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">üìê</div>
                        <div class="info-text">
                            Hidden dimension typically <span class="highlight-blue">4√ó d_model</span> (e.g., 2048)
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">üéØ</div>
                        <div class="info-text">
                            Applied <span class="highlight-blue">identically to each position</span> separately (position-wise)
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="layernorm-section">
                <div class="layernorm-box">
                    <div class="section-header">üìä Layer Normalization</div>
                    
                    <div class="property-card">
                        <div class="property-icon">üîÑ</div>
                        <div class="property-content">
                            <div class="property-title">Normalization</div>
                            <div class="property-text">
                                Normalizes across <span class="highlight-green">feature dimension</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="property-card">
                        <div class="property-icon">‚ö°</div>
                        <div class="property-content">
                            <div class="property-title">Training Benefits</div>
                            <div class="property-text">
                                <span class="highlight-green">Stabilizes training</span> and speeds convergence
                            </div>
                        </div>
                    </div>
                    
                    <div class="property-card">
                        <div class="property-icon">üéØ</div>
                        <div class="property-content">
                            <div class="property-title">Application</div>
                            <div class="property-text">
                                Applied after each sub-layer with residual connections
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="placement-box">
                    <div class="placement-title">‚öôÔ∏è Placement Strategy</div>
                    <div class="placement-text">
                        <span class="placement-highlight">Post-LN</span> vs <span class="placement-highlight">Pre-LN</span><br>
                        affects training dynamics
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Layer Normalization Calculation Example -->
    <div class="example-container">
        <div class="example-box">
            <div class="example-title">üìù Layer Normalization Calculation Example (d_model = 4)</div>
            
            <!-- Formula -->
            <div class="formula-section">
                <div class="formula-title">üìå Layer Normalization Formula</div>
                <div class="formula-content">
                    LayerNorm(x) = Œ≥ ‚äô (x - Œº) / ‚àö(œÉ¬≤ + Œµ) + Œ≤<br>
                    <span style="font-size: 13px; color: #666;">
                        Œº = mean, œÉ¬≤ = variance, Œ≥ = scale, Œ≤ = shift, Œµ = 1e-6
                    </span>
                </div>
            </div>

            <!-- Input Data -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">0</span>
                    Input Vector (After Self-Attention Output + Residual)
                </div>
                <div class="calc-content">
                    <strong>x</strong> = [ 0.5, &nbsp; 1.2, &nbsp; -0.3, &nbsp; 0.6 ]&nbsp;&nbsp;&nbsp;(4-dimensional vector)
                </div>
            </div>

            <div class="two-column">
                <!-- Step 1: Mean -->
                <div class="calc-step">
                    <div class="step-title">
                        <span class="step-number">1</span>
                        Calculate Mean (Œº)
                    </div>
                    <div class="calc-content">
                        Œº = (0.5 + 1.2 + (-0.3) + 0.6) / 4<br>
                        &nbsp; = 2.0 / 4<br>
                        <strong>&nbsp; = 0.5</strong>
                    </div>
                </div>

                <!-- Step 2: Variance -->
                <div class="calc-step">
                    <div class="step-title">
                        <span class="step-number">2</span>
                        Calculate Variance (œÉ¬≤)
                    </div>
                    <div class="calc-content">
                        œÉ¬≤ = [(0.5-0.5)¬≤ + (1.2-0.5)¬≤<br>
                        &nbsp;&nbsp;&nbsp;&nbsp; + (-0.3-0.5)¬≤ + (0.6-0.5)¬≤] / 4<br>
                        &nbsp;&nbsp; = [0 + 0.49 + 0.64 + 0.01] / 4<br>
                        <strong>&nbsp;&nbsp; = 0.285</strong>
                    </div>
                </div>
            </div>

            <!-- Step 3: Standard Deviation -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">3</span>
                    Calculate Standard Deviation
                </div>
                <div class="calc-content">
                    ‚àö(œÉ¬≤ + Œµ) = ‚àö(0.285 + 0.000001) ‚âà ‚àö0.285 ‚âà <strong>0.534</strong>
                </div>
            </div>

            <!-- Step 4: Normalization -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">4</span>
                    Normalization (Applied to Each Element)
                </div>
                <div class="calc-content">
                    xÃÇ‚ÇÅ = (0.5 - 0.5) / 0.534 = 0 / 0.534 = <strong>0.000</strong><br>
                    xÃÇ‚ÇÇ = (1.2 - 0.5) / 0.534 = 0.7 / 0.534 ‚âà <strong>1.311</strong><br>
                    xÃÇ‚ÇÉ = (-0.3 - 0.5) / 0.534 = -0.8 / 0.534 ‚âà <strong>-1.498</strong><br>
                    xÃÇ‚ÇÑ = (0.6 - 0.5) / 0.534 = 0.1 / 0.534 ‚âà <strong>0.187</strong>
                </div>
            </div>

            <!-- Step 5: Scale & Shift -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">5</span>
                    Apply Scale (Œ≥) & Shift (Œ≤)
                </div>
                <div class="calc-content">
                    When Œ≥ = [1.0, 1.0, 1.0, 1.0], &nbsp; Œ≤ = [0.0, 0.0, 0.0, 0.0]:<br><br>
                    y = Œ≥ ‚äô xÃÇ + Œ≤ = <strong>[ 0.000, &nbsp; 1.311, &nbsp; -1.498, &nbsp; 0.187 ]</strong>
                </div>
            </div>

            <!-- Final Result -->
            <div class="result-box">
                <div class="result-label">‚úÖ Final Result (LayerNorm Output)</div>
                <div class="result-value">
                    LayerNorm(x) = [ 0.000, &nbsp; 1.311, &nbsp; -1.498, &nbsp; 0.187 ]
                </div>
            </div>

            <!-- Verification -->
            <div class="note-box">
                <div class="note-icon">üí°</div>
                <div class="note-text">
                    <strong>Verification:</strong> Normalized vector has <span class="highlight-orange">mean ‚âà 0</span>, <span class="highlight-orange">variance ‚âà 1</span><br>
                    Mean: (0 + 1.311 - 1.498 + 0.187) / 4 ‚âà 0 ‚úì<br>
                    Variance: (0¬≤ + 1.311¬≤ + 1.498¬≤ + 0.187¬≤) / 4 ‚âà 1 ‚úì
                </div>
            </div>
        </div>
    </div>

    <!-- Layer Normalization for Sequence Matrix -->
    <div class="example-container">
        <div class="example-box">
            <div class="example-title">üìù Layer Normalization for Sequence Matrix (3√ó4 Matrix)</div>

            <!-- Input Matrix -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">0</span>
                    Input Matrix X (3 tokens √ó 4 dimensions)
                </div>
                <div class="calc-content" style="text-align: center;">
                    Attention Output + Residual for "I go to school" sequence<br><br>
                    <table style="margin: 0 auto; border-collapse: collapse; font-family: 'Courier New', monospace;">
                        <tr>
                            <td style="padding: 4px 8px; text-align: right; color: #666; font-size: 12px;">I</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">0.42</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">0.88</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">0.05</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">1.55</td>
                        </tr>
                        <tr>
                            <td style="padding: 4px 8px; text-align: right; color: #666; font-size: 12px;">go to</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">1.08</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">1.14</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">-0.18</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">1.41</td>
                        </tr>
                        <tr>
                            <td style="padding: 4px 8px; text-align: right; color: #666; font-size: 12px;">school</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">0.59</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">-0.19</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">0.47</td>
                            <td style="padding: 4px 12px; border: 1px solid #16a34a;">1.33</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="note-box">
                <div class="note-icon">‚ö†Ô∏è</div>
                <div class="note-text">
                    <strong>Key Point:</strong> Layer Normalization is applied <span class="highlight-orange">independently to each row (token)</span>.<br>
                    That is, mean and variance are computed over the 4-dimensional features for each token.
                </div>
            </div>

            <!-- Row 1 Calculation -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">1</span>
                    Row 1 ("I") Normalization: x = [0.42, 0.88, 0.05, 1.55]
                </div>
                <div class="calc-content">
                    Œº‚ÇÅ = (0.42 + 0.88 + 0.05 + 1.55) / 4 = 2.90 / 4 = <strong>0.725</strong><br><br>
                    œÉ‚ÇÅ¬≤ = [(-0.305)¬≤ + (0.155)¬≤ + (-0.675)¬≤ + (0.825)¬≤] / 4<br>
                    &nbsp;&nbsp;&nbsp; = [0.093 + 0.024 + 0.456 + 0.681] / 4 = <strong>0.3135</strong><br><br>
                    ‚àö(œÉ‚ÇÅ¬≤ + Œµ) ‚âà <strong>0.560</strong><br><br>
                    LayerNorm(Row1) = [<strong>-0.545, 0.277, -1.205, 1.473</strong>]
                </div>
            </div>

            <!-- Row 2 Calculation -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">2</span>
                    Row 2 ("go to") Normalization: x = [1.08, 1.14, -0.18, 1.41]
                </div>
                <div class="calc-content">
                    Œº‚ÇÇ = (1.08 + 1.14 + (-0.18) + 1.41) / 4 = 3.45 / 4 = <strong>0.8625</strong><br><br>
                    œÉ‚ÇÇ¬≤ = [(0.2175)¬≤ + (0.2775)¬≤ + (-1.0425)¬≤ + (0.5475)¬≤] / 4<br>
                    &nbsp;&nbsp;&nbsp; = [0.047 + 0.077 + 1.087 + 0.300] / 4 = <strong>0.378</strong><br><br>
                    ‚àö(œÉ‚ÇÇ¬≤ + Œµ) ‚âà <strong>0.615</strong><br><br>
                    LayerNorm(Row2) = [<strong>0.354, 0.451, -1.695, 0.890</strong>]
                </div>
            </div>

            <!-- Row 3 Calculation -->
            <div class="calc-step">
                <div class="step-title">
                    <span class="step-number">3</span>
                    Row 3 ("school") Normalization: x = [0.59, -0.19, 0.47, 1.33]
                </div>
                <div class="calc-content">
                    Œº‚ÇÉ = (0.59 + (-0.19) + 0.47 + 1.33) / 4 = 2.20 / 4 = <strong>0.55</strong><br><br>
                    œÉ‚ÇÉ¬≤ = [(0.04)¬≤ + (-0.74)¬≤ + (-0.08)¬≤ + (0.78)¬≤] / 4<br>
                    &nbsp;&nbsp;&nbsp; = [0.002 + 0.548 + 0.006 + 0.608] / 4 = <strong>0.291</strong><br><br>
                    ‚àö(œÉ‚ÇÉ¬≤ + Œµ) ‚âà <strong>0.539</strong><br><br>
                    LayerNorm(Row3) = [<strong>0.074, -1.373, -0.148, 1.447</strong>]
                </div>
            </div>

            <!-- Final Result Matrix -->
            <div class="result-box">
                <div class="result-label">‚úÖ Final Result Matrix (Œ≥=1, Œ≤=0)</div>
                <div class="result-value">
                    <table style="margin: 0 auto; border-collapse: collapse; font-family: 'Courier New', monospace;">
                        <tr>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">-0.545</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">0.277</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">-1.205</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">1.473</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">0.354</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">0.451</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">-1.695</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">0.890</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">0.074</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">-1.373</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">-0.148</td>
                            <td style="padding: 6px 14px; border: 1px solid #16a34a; background: #f0fdf4;">1.447</td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- Comparison Note -->
            <div class="note-box">
                <div class="note-icon">üìä</div>
                <div class="note-text">
                    <strong>Layer Norm vs Batch Norm Comparison:</strong><br>
                    ‚Ä¢ <span class="highlight-orange">Layer Norm:</span> Normalizes over feature dimension for each sample (token) ‚Üí Independent of batch size<br>
                    ‚Ä¢ <span class="highlight-orange">Batch Norm:</span> Normalizes over batch for each feature ‚Üí Not suitable for sequence models
                </div>
            </div>
        </div>
    </div>
</body>
</html>
