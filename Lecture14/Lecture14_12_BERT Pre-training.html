<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BERT Pre-training</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: #ffffff;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            width: 960px;
            position: relative;
            background: #ffffff;
            padding: 25px 40px;
        }
        
        .title {
            font-size: 26px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .tasks-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .task-box {
            background: #F8F9FA;
            border: 3px solid #1E64C8;
            border-radius: 12px;
            padding: 18px;
            display: flex;
            flex-direction: column;
        }
        
        .task-header {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #1E64C8;
        }
        
        .task-number {
            display: inline-block;
            background: #1E64C8;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            line-height: 28px;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .task-title {
            font-size: 19px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 3px;
        }
        
        .task-subtitle {
            font-size: 16px;
            color: #666666;
        }
        
        .example-box {
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
        }
        
        .example-label {
            font-size: 14px;
            font-weight: 600;
            color: #666666;
            margin-bottom: 8px;
        }
        
        .sentence-display {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        
        .token {
            background: #E8F4F8;
            border: 2px solid #1E64C8;
            border-radius: 6px;
            padding: 5px 10px;
            font-size: 15px;
            font-weight: 500;
            color: #1E64C8;
        }
        
        .token.special {
            background: #C8E6C9;
            border-color: #4CAF50;
            color: #2E7D32;
            font-weight: 600;
        }
        
        .token.masked {
            background: #FFE0B2;
            border-color: #FF9800;
            color: #E65100;
            font-weight: 600;
        }
        
        .arrow-down {
            text-align: center;
            font-size: 20px;
            color: #1E64C8;
            margin: 5px 0;
        }
        
        .prediction {
            text-align: center;
            font-size: 16px;
            color: #333333;
            background: #E8F4F8;
            padding: 8px;
            border-radius: 6px;
            font-weight: 500;
        }
        
        .nsp-sentences {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .nsp-sentence {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 6px;
            padding: 8px 10px;
        }
        
        .sentence-label {
            font-size: 14px;
            font-weight: 600;
            color: #1E64C8;
            flex-shrink: 0;
        }
        
        .sentence-text {
            font-size: 15px;
            color: #333333;
        }
        
        .classification-result {
            text-align: center;
            font-size: 16px;
            color: white;
            background: #4CAF50;
            padding: 8px;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .bottom-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }
        
        .info-card {
            background: #E8F4F8;
            border-left: 4px solid #1E64C8;
            border-radius: 6px;
            padding: 10px 12px;
        }
        
        .info-title {
            font-size: 16px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 4px;
        }
        
        .info-text {
            font-size: 16px;
            color: #333333;
            line-height: 1.3;
        }
        
        .highlight {
            font-weight: 600;
            color: #1E64C8;
        }
        
        .special-tokens {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }
        
        .special-token-item {
            background: #C8E6C9;
            border: 2px solid #4CAF50;
            border-radius: 5px;
            padding: 3px 8px;
            font-size: 14px;
            font-weight: 600;
            color: #2E7D32;
        }

        /* New styles for numerical examples section */
        .section-divider {
            margin: 40px 0 30px 0;
            border-top: 3px solid #1E64C8;
            position: relative;
        }
        
        .section-divider::after {
            content: '';
            position: absolute;
            top: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 6px;
            background: #1E64C8;
            border-radius: 3px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #1E64C8;
            margin: 25px 0 20px 0;
            text-align: center;
        }
        
        .subsection-title {
            font-size: 20px;
            font-weight: 600;
            color: #1E64C8;
            margin: 25px 0 15px 0;
            padding-left: 12px;
            border-left: 4px solid #1E64C8;
        }
        
        .step-container {
            background: #F8F9FA;
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 15px;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .step-number {
            background: #1E64C8;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .step-title {
            font-size: 17px;
            font-weight: 600;
            color: #333;
        }
        
        .vector-box {
            background: white;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 10px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
        
        .vector-label {
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 5px;
            font-family: Aptos, 'Segoe UI', sans-serif;
            font-size: 14px;
        }
        
        .vector-content {
            color: #333;
            line-height: 1.6;
        }
        
        .vector-highlight {
            background: #FFE0B2;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .vector-special {
            background: #C8E6C9;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .formula-box {
            background: #E8F4F8;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 15px;
            margin: 12px 0;
            text-align: center;
        }
        
        .formula {
            font-family: 'Times New Roman', serif;
            font-size: 18px;
            color: #1E64C8;
            font-style: italic;
        }
        
        .matrix-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .matrix {
            background: white;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
        }
        
        .matrix-label {
            text-align: center;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 8px;
            font-family: Aptos, 'Segoe UI', sans-serif;
            font-size: 13px;
        }
        
        .matrix-grid {
            display: grid;
            gap: 3px;
        }
        
        .matrix-row {
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        
        .matrix-cell {
            width: 45px;
            text-align: right;
            color: #333;
        }
        
        .matrix-cell.highlight {
            background: #FFE0B2;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .operator {
            font-size: 24px;
            color: #1E64C8;
            font-weight: 600;
        }
        
        .explanation {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            margin-top: 10px;
            padding: 10px;
            background: #FFFDE7;
            border-left: 3px solid #FFC107;
            border-radius: 0 6px 6px 0;
        }
        
        .result-box {
            background: linear-gradient(135deg, #C8E6C9 0%, #A5D6A7 100%);
            border: 2px solid #4CAF50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .result-label {
            font-weight: 600;
            color: #2E7D32;
            font-size: 16px;
            margin-bottom: 8px;
        }
        
        .result-value {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            color: #1B5E20;
        }
        
        .loss-box {
            background: linear-gradient(135deg, #FFCDD2 0%, #EF9A9A 100%);
            border: 2px solid #F44336;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .loss-label {
            font-weight: 600;
            color: #C62828;
            font-size: 16px;
            margin-bottom: 8px;
            text-align: center;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .flow-arrow {
            text-align: center;
            font-size: 28px;
            color: #1E64C8;
            margin: 10px 0;
        }
        
        .token-embedding-visual {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .token-box {
            text-align: center;
        }
        
        .token-word {
            background: #E8F4F8;
            border: 2px solid #1E64C8;
            border-radius: 6px;
            padding: 6px 12px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 5px;
        }
        
        .token-word.masked {
            background: #FFE0B2;
            border-color: #FF9800;
            color: #E65100;
        }
        
        .token-id {
            font-size: 11px;
            color: #666;
        }
        
        .plus-sign {
            font-size: 20px;
            color: #1E64C8;
            font-weight: 600;
        }
        
        .attention-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 2px;
            max-width: 300px;
            margin: 10px auto;
        }
        
        .attention-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            border-radius: 3px;
        }
        
        .probability-bar-container {
            margin: 10px 0;
        }
        
        .probability-bar {
            display: flex;
            align-items: center;
            margin: 5px 0;
            gap: 10px;
        }
        
        .prob-label {
            width: 80px;
            font-size: 13px;
            font-weight: 500;
            color: #333;
        }
        
        .prob-bar {
            flex: 1;
            height: 24px;
            background: #E0E0E0;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .prob-fill {
            height: 100%;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding-left: 8px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }
        
        .prob-fill.high {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
        }
        
        .prob-fill.medium {
            background: linear-gradient(90deg, #FF9800, #FFC107);
        }
        
        .prob-fill.low {
            background: linear-gradient(90deg, #9E9E9E, #BDBDBD);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">BERT Pre-training: Two Main Tasks</div>
        
        <div class="tasks-grid">
            <!-- MLM Task -->
            <div class="task-box">
                <div class="task-header">
                    <div class="task-number">1</div>
                    <div class="task-title">Masked Language Model</div>
                    <div class="task-subtitle">MLM - 15% masking</div>
                </div>
                
                <div class="example-box">
                    <div class="example-label">Input:</div>
                    <div class="sentence-display">
                        <div class="token special">[CLS]</div>
                        <div class="token">The</div>
                        <div class="token">cat</div>
                        <div class="token masked">[MASK]</div>
                        <div class="token">on</div>
                        <div class="token">the</div>
                        <div class="token">mat</div>
                    </div>
                    <div class="arrow-down">‚Üì</div>
                    <div class="prediction">Predict: <span class="highlight">"sat"</span></div>
                </div>
                
                <div style="font-size: 16px; color: #333333; line-height: 1.5; text-align: center;">
                    Uses <span class="highlight">bidirectional context</span><br>
                    to predict masked tokens
                </div>
            </div>
            
            <!-- NSP Task -->
            <div class="task-box">
                <div class="task-header">
                    <div class="task-number">2</div>
                    <div class="task-title">Next Sentence Prediction</div>
                    <div class="task-subtitle">NSP - Binary classification</div>
                </div>
                
                <div class="example-box">
                    <div class="example-label">Input:</div>
                    <div class="nsp-sentences">
                        <div class="nsp-sentence">
                            <div class="sentence-label">A:</div>
                            <div class="sentence-text">The man went to the store.</div>
                        </div>
                        <div class="nsp-sentence">
                            <div class="sentence-label">B:</div>
                            <div class="sentence-text">He bought a gallon of milk.</div>
                        </div>
                    </div>
                    <div class="arrow-down">‚Üì</div>
                    <div class="classification-result">IsNext ‚úî</div>
                </div>
                
                <div style="font-size: 16px; color: #333333; line-height: 1.5; text-align: center;">
                    <span class="highlight">[CLS]</span> token for<br>
                    sentence-level representation
                </div>
            </div>
        </div>
        
        <div class="bottom-info">
            <div class="info-card">
                <div class="info-title">üî§ Tokenization</div>
                <div class="info-text">
                    <strong>WordPiece</strong><br>
                    30K vocabulary
                </div>
            </div>
            
            <div class="info-card">
                <div class="info-title">üè∑Ô∏è Special Tokens</div>
                <div class="special-tokens">
                    <div class="special-token-item">[CLS]</div>
                    <div class="special-token-item">[SEP]</div>
                    <div class="special-token-item">[MASK]</div>
                    <div class="special-token-item">[PAD]</div>
                </div>
            </div>
            
            <div class="info-card">
                <div class="info-title">‚ö° Training</div>
                <div class="info-text">
                    <strong>4 days</strong><br>
                    on 4-16 Cloud TPUs
                </div>
            </div>
        </div>

        <!-- ============================================== -->
        <!-- NEW SECTION: Numerical Vector Examples -->
        <!-- ============================================== -->
        
        <div class="section-divider"></div>
        
        <div class="section-title">üìä Numerical Vector Calculation Examples</div>
        
        <!-- ========== TRAINING SECTION ========== -->
        <div class="subsection-title">üéØ Training Phase: Forward & Backward Pass</div>
        
        <p style="color: #666; font-size: 14px; margin-bottom: 15px; line-height: 1.6;">
            Let's walk through BERT training with simplified dimensions (d=4) for clarity. Real BERT uses d=768.
            <br>Input: <strong>"[CLS] The cat [MASK] on"</strong> where [MASK] should predict "sat"
        </p>
        
        <!-- Step 1: Tokenization -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Tokenization & Token IDs</div>
            </div>
            
            <div class="token-embedding-visual">
                <div class="token-box">
                    <div class="token-word" style="background: #C8E6C9; border-color: #4CAF50; color: #2E7D32;">[CLS]</div>
                    <div class="token-id">ID: 101</div>
                </div>
                <div class="token-box">
                    <div class="token-word">The</div>
                    <div class="token-id">ID: 1996</div>
                </div>
                <div class="token-box">
                    <div class="token-word">cat</div>
                    <div class="token-id">ID: 4937</div>
                </div>
                <div class="token-box">
                    <div class="token-word masked">[MASK]</div>
                    <div class="token-id">ID: 103</div>
                </div>
                <div class="token-box">
                    <div class="token-word">on</div>
                    <div class="token-id">ID: 2006</div>
                </div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Token ID Sequence:</div>
                <div class="vector-content">
                    input_ids = [<span class="vector-special">101</span>, 1996, 4937, <span class="vector-highlight">103</span>, 2006]
                </div>
            </div>
        </div>
        
        <!-- Step 2: Embedding Lookup -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">Embedding Lookup (Token + Position + Segment)</div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Token Embeddings (from embedding matrix, d=4):</div>
                <div class="vector-content">
                    E<sub>[CLS]</sub> &nbsp;= [0.12, -0.34, 0.56, 0.23]<br>
                    E<sub>The</sub> &nbsp;&nbsp;= [0.45, 0.67, -0.12, 0.89]<br>
                    E<sub>cat</sub> &nbsp;&nbsp;= [0.78, -0.45, 0.34, -0.67]<br>
                    E<sub>[MASK]</sub> = [<span class="vector-highlight">0.11, 0.22, 0.33, 0.44</span>]<br>
                    E<sub>on</sub> &nbsp;&nbsp;&nbsp;= [-0.23, 0.56, 0.78, 0.12]
                </div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Position Embeddings (learned):</div>
                <div class="vector-content">
                    P<sub>0</sub> = [0.01, 0.02, 0.01, 0.02]<br>
                    P<sub>1</sub> = [0.03, 0.01, 0.04, 0.02]<br>
                    P<sub>2</sub> = [0.02, 0.05, 0.01, 0.03]<br>
                    P<sub>3</sub> = [0.04, 0.02, 0.03, 0.01]<br>
                    P<sub>4</sub> = [0.01, 0.03, 0.02, 0.04]
                </div>
            </div>
            
            <div class="formula-box">
                <div class="formula">Input<sub>i</sub> = TokenEmbed<sub>i</sub> + PositionEmbed<sub>i</sub> + SegmentEmbed<sub>i</sub></div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Final Input Embeddings (after addition):</div>
                <div class="vector-content">
                    H<sup>0</sup><sub>[CLS]</sub> &nbsp;= [0.13, -0.32, 0.57, 0.25]<br>
                    H<sup>0</sup><sub>The</sub> &nbsp;&nbsp;= [0.48, 0.68, -0.08, 0.91]<br>
                    H<sup>0</sup><sub>cat</sub> &nbsp;&nbsp;= [0.80, -0.40, 0.35, -0.64]<br>
                    H<sup>0</sup><sub>[MASK]</sub> = [<span class="vector-highlight">0.15, 0.24, 0.36, 0.45</span>]<br>
                    H<sup>0</sup><sub>on</sub> &nbsp;&nbsp;&nbsp;= [-0.22, 0.59, 0.80, 0.16]
                </div>
            </div>
        </div>
        
        <!-- Step 3: Self-Attention -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">Self-Attention Calculation</div>
            </div>
            
            <div class="formula-box">
                <div class="formula">Attention(Q, K, V) = softmax(QK<sup>T</sup> / ‚àöd<sub>k</sub>) ¬∑ V</div>
            </div>
            
            <div class="two-column">
                <div class="vector-box">
                    <div class="vector-label">Query for [MASK] position:</div>
                    <div class="vector-content">
                        Q<sub>[MASK]</sub> = H<sup>0</sup><sub>[MASK]</sub> ¬∑ W<sub>Q</sub><br>
                        = [0.15, 0.24, 0.36, 0.45] ¬∑ W<sub>Q</sub><br>
                        = [<span class="vector-highlight">0.42, -0.18, 0.31, 0.55</span>]
                    </div>
                </div>
                <div class="vector-box">
                    <div class="vector-label">Keys for all positions:</div>
                    <div class="vector-content">
                        K<sub>[CLS]</sub> = [0.22, 0.45, -0.12, 0.33]<br>
                        K<sub>The</sub> = [0.56, 0.11, 0.44, -0.23]<br>
                        K<sub>cat</sub> = [0.78, -0.34, 0.21, 0.67]<br>
                        K<sub>[MASK]</sub> = [0.33, 0.22, 0.55, 0.11]<br>
                        K<sub>on</sub> = [-0.11, 0.67, 0.33, 0.44]
                    </div>
                </div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Attention Scores (Q<sub>[MASK]</sub> ¬∑ K<sup>T</sup> / ‚àö4):</div>
                <div class="vector-content">
                    score([MASK]‚Üí[CLS]) = (0.42√ó0.22 + (-0.18)√ó0.45 + 0.31√ó(-0.12) + 0.55√ó0.33) / 2 = <strong>0.12</strong><br>
                    score([MASK]‚ÜíThe) &nbsp;= (0.42√ó0.56 + (-0.18)√ó0.11 + 0.31√ó0.44 + 0.55√ó(-0.23)) / 2 = <strong>0.14</strong><br>
                    score([MASK]‚Üícat) &nbsp;= (0.42√ó0.78 + (-0.18)√ó(-0.34) + 0.31√ó0.21 + 0.55√ó0.67) / 2 = <strong class="vector-highlight">0.41</strong><br>
                    score([MASK]‚Üí[MASK]) = <strong>0.18</strong><br>
                    score([MASK]‚Üíon) &nbsp;&nbsp;= <strong>0.25</strong>
                </div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">After Softmax (Attention Weights):</div>
                <div class="vector-content">
                    Œ± = softmax([0.12, 0.14, 0.41, 0.18, 0.25])<br>
                    &nbsp;&nbsp;= [<span style="color:#666">0.14</span>, <span style="color:#666">0.15</span>, <span class="vector-highlight">0.25</span>, <span style="color:#666">0.16</span>, <span style="color:#666">0.19</span>]
                </div>
            </div>
            
            <div class="explanation">
                üí° Notice "cat" gets the highest attention (0.25) - BERT learns that "cat" is crucial context for predicting what action the cat performed!
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Weighted Sum of Values ‚Üí New [MASK] representation:</div>
                <div class="vector-content">
                    H<sup>1</sup><sub>[MASK]</sub> = 0.14√óV<sub>[CLS]</sub> + 0.15√óV<sub>The</sub> + <span class="vector-highlight">0.25√óV<sub>cat</sub></span> + 0.16√óV<sub>[MASK]</sub> + 0.19√óV<sub>on</sub><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [<span class="vector-highlight">0.52, -0.15, 0.48, 0.33</span>]
                </div>
            </div>
        </div>
        
        <!-- Step 4: Feed-Forward & Output -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">4</div>
                <div class="step-title">MLM Output: Predict Masked Token</div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Final hidden state at [MASK] position (after 12 layers):</div>
                <div class="vector-content">
                    H<sup>12</sup><sub>[MASK]</sub> = [<span class="vector-highlight">0.89, -0.23, 0.67, 0.45</span>]
                </div>
            </div>
            
            <div class="formula-box">
                <div class="formula">logits = H<sup>12</sup><sub>[MASK]</sub> ¬∑ W<sub>vocab</sub><sup>T</sup> + b &nbsp;&nbsp;(30,522 vocabulary scores)</div>
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Vocabulary Logits (showing top words):</div>
                <div class="vector-content">
                    logits["sat"] &nbsp;&nbsp;= <span class="vector-highlight">3.45</span> &nbsp;‚Üê Highest!<br>
                    logits["jumped"] = 2.12<br>
                    logits["ran"] &nbsp;&nbsp;= 1.89<br>
                    logits["slept"] &nbsp;= 1.67<br>
                    logits["the"] &nbsp;&nbsp;= -2.34<br>
                    ... (30,517 more)
                </div>
            </div>
            
            <div class="probability-bar-container">
                <div style="font-weight: 600; color: #1E64C8; margin-bottom: 10px;">After Softmax ‚Üí Probabilities:</div>
                <div class="probability-bar">
                    <div class="prob-label">"sat"</div>
                    <div class="prob-bar">
                        <div class="prob-fill high" style="width: 72%;">P = 0.72</div>
                    </div>
                </div>
                <div class="probability-bar">
                    <div class="prob-label">"jumped"</div>
                    <div class="prob-bar">
                        <div class="prob-fill medium" style="width: 15%;">0.15</div>
                    </div>
                </div>
                <div class="probability-bar">
                    <div class="prob-label">"ran"</div>
                    <div class="prob-bar">
                        <div class="prob-fill low" style="width: 8%;">0.08</div>
                    </div>
                </div>
                <div class="probability-bar">
                    <div class="prob-label">others</div>
                    <div class="prob-bar">
                        <div class="prob-fill low" style="width: 5%;">0.05</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Step 5: Loss Calculation -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">5</div>
                <div class="step-title">Loss Calculation & Backpropagation</div>
            </div>
            
            <div class="loss-box">
                <div class="loss-label">Cross-Entropy Loss for MLM</div>
                <div class="formula-box" style="background: white; margin: 10px 0;">
                    <div class="formula">L<sub>MLM</sub> = -log(P(sat | context)) = -log(0.72) = <strong>0.329</strong></div>
                </div>
            </div>
            
            <div class="two-column">
                <div class="vector-box">
                    <div class="vector-label">NSP Loss (if IsNext=True, P=0.85):</div>
                    <div class="vector-content">
                        L<sub>NSP</sub> = -log(0.85) = <strong>0.163</strong>
                    </div>
                </div>
                <div class="vector-box">
                    <div class="vector-label">Total Pre-training Loss:</div>
                    <div class="vector-content">
                        L<sub>total</sub> = L<sub>MLM</sub> + L<sub>NSP</sub><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0.329 + 0.163 = <strong>0.492</strong>
                    </div>
                </div>
            </div>
            
            <div class="explanation">
                üí° <strong>Backpropagation:</strong> Gradients flow back through all 12 layers. If prediction was wrong (e.g., predicted "jumped" instead of "sat"), the loss would be higher, causing larger gradient updates to better capture the cat-sitting relationship.
            </div>
            
            <div class="vector-box">
                <div class="vector-label">Gradient Update Example (simplified):</div>
                <div class="vector-content">
                    ‚àÇL/‚àÇW<sub>vocab</sub>["sat"] = H<sup>12</sup><sub>[MASK]</sub> √ó (P<sub>sat</sub> - 1) = [0.89, -0.23, 0.67, 0.45] √ó (0.72-1)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [<span style="color: #C62828">-0.25, 0.06, -0.19, -0.13</span>]<br><br>
                    W<sub>vocab</sub>["sat"]<sup>new</sup> = W<sub>vocab</sub>["sat"]<sup>old</sup> - Œ∑ √ó gradient<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [...] - 0.0001 √ó [-0.25, 0.06, -0.19, -0.13]
                </div>
            </div>
        </div>
        
        <!-- ========== INFERENCE SECTION ========== -->
        <div class="subsection-title">üîÆ Inference Phase: Using Pre-trained BERT</div>
        
        <p style="color: #666; font-size: 14px; margin-bottom: 15px; line-height: 1.6;">
            After pre-training, BERT can be used for various downstream tasks. Here's how inference works:
        </p>
        
        <!-- Inference Example 1: Fill-in-the-blank -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">A</div>
                <div class="step-title">Fill-in-the-Blank (MLM-style Inference)</div>
            </div>
            
            <p style="font-size: 14px; color: #666; margin-bottom: 12px;">
                Input: "The weather today is [MASK]."
            </p>
            
            <div class="vector-box">
                <div class="vector-label">Step 1: Tokenize & Embed</div>
                <div class="vector-content">
                    tokens = ["[CLS]", "The", "weather", "today", "is", "[MASK]", ".", "[SEP]"]<br>
                    input_ids = [101, 1996, 4633, 2651, 2003, <span class="vector-highlight">103</span>, 1012, 102]
                </div>
            </div>
            
            <div class="flow-arrow">‚Üì</div>
            
            <div class="vector-box">
                <div class="vector-label">Step 2: Forward Pass through 12 Transformer Layers</div>
                <div class="vector-content">
                    H<sup>0</sup> ‚Üí Attention ‚Üí FFN ‚Üí LayerNorm ‚Üí H<sup>1</sup> ‚Üí ... ‚Üí H<sup>12</sup><br><br>
                    H<sup>12</sup><sub>[MASK]</sub> = [<span class="vector-highlight">0.76, 0.34, -0.52, 0.91</span>]
                </div>
            </div>
            
            <div class="flow-arrow">‚Üì</div>
            
            <div class="result-box">
                <div class="result-label">Step 3: Vocabulary Projection ‚Üí Top Predictions</div>
                <div class="result-value">
                    #1: "sunny" (P=0.31) &nbsp; #2: "nice" (P=0.18) &nbsp; #3: "beautiful" (P=0.12) &nbsp; #4: "cold" (P=0.09)
                </div>
            </div>
        </div>
        
        <!-- Inference Example 2: Sentence Classification -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">B</div>
                <div class="step-title">Sentiment Classification (Fine-tuned BERT)</div>
            </div>
            
            <p style="font-size: 14px; color: #666; margin-bottom: 12px;">
                Input: "I absolutely loved this movie!"
            </p>
            
            <div class="vector-box">
                <div class="vector-label">Step 1: Get [CLS] Token Representation</div>
                <div class="vector-content">
                    H<sup>12</sup><sub>[CLS]</sub> = [0.82, -0.45, 0.67, 0.23, ..., 0.91] &nbsp;(768 dimensions)
                </div>
            </div>
            
            <div class="flow-arrow">‚Üì</div>
            
            <div class="vector-box">
                <div class="vector-label">Step 2: Classification Head (Linear Layer)</div>
                <div class="vector-content">
                    logits = H<sup>12</sup><sub>[CLS]</sub> ¬∑ W<sub>classifier</sub> + b<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [<span style="color:#C62828">-1.23</span>, <span style="color:#4CAF50">2.87</span>] &nbsp;‚Üê [Negative, Positive]
                </div>
            </div>
            
            <div class="flow-arrow">‚Üì</div>
            
            <div class="formula-box">
                <div class="formula">P = softmax([-1.23, 2.87]) = [<span style="color:#C62828">0.02</span>, <span style="color:#4CAF50">0.98</span>]</div>
            </div>
            
            <div class="result-box">
                <div class="result-label">Final Prediction</div>
                <div class="result-value" style="font-size: 16px;">
                    ‚úÖ Positive Sentiment (98% confidence)
                </div>
            </div>
        </div>
        
        <!-- Inference Example 3: Token Classification -->
        <div class="step-container">
            <div class="step-header">
                <div class="step-number">C</div>
                <div class="step-title">Named Entity Recognition (Token Classification)</div>
            </div>
            
            <p style="font-size: 14px; color: #666; margin-bottom: 12px;">
                Input: "Barack Obama visited Paris"
            </p>
            
            <div class="vector-box">
                <div class="vector-label">Each Token's Hidden State ‚Üí Entity Label</div>
                <div class="vector-content">
                    H<sup>12</sup><sub>Barack</sub> ‚Üí W<sub>NER</sub> ‚Üí logits ‚Üí softmax ‚Üí <span style="background: #BBDEFB; padding: 2px 6px; border-radius: 3px;"><strong>B-PER</strong></span> (0.94)<br>
                    H<sup>12</sup><sub>Obama</sub> &nbsp;‚Üí W<sub>NER</sub> ‚Üí logits ‚Üí softmax ‚Üí <span style="background: #BBDEFB; padding: 2px 6px; border-radius: 3px;"><strong>I-PER</strong></span> (0.91)<br>
                    H<sup>12</sup><sub>visited</sub> ‚Üí W<sub>NER</sub> ‚Üí logits ‚Üí softmax ‚Üí <span style="background: #E0E0E0; padding: 2px 6px; border-radius: 3px;"><strong>O</strong></span> (0.97)<br>
                    H<sup>12</sup><sub>Paris</sub> &nbsp;‚Üí W<sub>NER</sub> ‚Üí logits ‚Üí softmax ‚Üí <span style="background: #C8E6C9; padding: 2px 6px; border-radius: 3px;"><strong>B-LOC</strong></span> (0.89)
                </div>
            </div>
            
            <div class="result-box">
                <div class="result-label">Extracted Entities</div>
                <div class="result-value">
                    <span style="background: #BBDEFB; padding: 3px 8px; border-radius: 4px; margin-right: 10px;">Barack Obama ‚Üí PERSON</span>
                    <span style="background: #C8E6C9; padding: 3px 8px; border-radius: 4px;">Paris ‚Üí LOCATION</span>
                </div>
            </div>
        </div>
        
        <!-- Summary Box -->
        <div class="step-container" style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-color: #1E64C8;">
            <div class="step-header">
                <div class="step-number" style="background: #0D47A1;">‚òÖ</div>
                <div class="step-title">Key Differences: Training vs Inference</div>
            </div>
            
            <div class="two-column" style="gap: 20px;">
                <div style="background: white; border-radius: 8px; padding: 15px;">
                    <div style="font-weight: 600; color: #1E64C8; margin-bottom: 10px; font-size: 16px;">üéì Training</div>
                    <ul style="font-size: 14px; color: #333; line-height: 1.8; padding-left: 20px;">
                        <li>Random 15% tokens masked</li>
                        <li>Loss calculated & backpropagation</li>
                        <li>Weights updated via optimizer</li>
                        <li>Batch processing (256-512 samples)</li>
                        <li>Dropout enabled (p=0.1)</li>
                    </ul>
                </div>
                <div style="background: white; border-radius: 8px; padding: 15px;">
                    <div style="font-weight: 600; color: #4CAF50; margin-bottom: 10px; font-size: 16px;">üöÄ Inference</div>
                    <ul style="font-size: 14px; color: #333; line-height: 1.8; padding-left: 20px;">
                        <li>No masking (or intentional [MASK])</li>
                        <li>Forward pass only</li>
                        <li>Weights frozen (no updates)</li>
                        <li>Single sample or small batches</li>
                        <li>Dropout disabled (deterministic)</li>
                    </ul>
                </div>
            </div>
        </div>
        
    </div>
</body>
</html>